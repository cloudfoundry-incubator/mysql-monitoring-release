<%=

config = {
  username: p('mysql-metrics.username'),
  password: p('mysql-metrics.password'),
  pidfile: '/var/vcap/sys/run/mysql-metrics/mysql-metrics.pid',
  metrics_frequency: p('mysql-metrics.metrics_frequency'),
  origin: p('mysql-metrics.origin'),
  emit_leader_follower_metrics: p('mysql-metrics.leader_follower_enabled')
}
if config[:metrics_frequency] < p('mysql-metrics.minimum_metrics_frequency')
  raise 'metrics_frequency < minimum_metrics_frequency: collecting metrics at this rate is not advised'
end

# JSON is valid yaml
JSON.pretty_generate(config)

%>

